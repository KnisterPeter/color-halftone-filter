<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Halftone screen filter</title>
<style>
body {
	margin: 0px;
	font-family:Helvetica, Arial, sans-serif;
	font-size:12px;
}

#container {
	position: relative;
	background-color:#e3ddd8;
}
</style>
<script src="js/tsunami/utils/Debug.js"></script>
<script src="js/tsunami/geom/Rectangle.js"></script>
<script src="js/tsunami/geom/Point.js"></script>
<script src="js/tsunami/geom/Ratio.js"></script>
<script src="js/tsunami/filters/Blendmode.js"></script>
<script src="js/tsunami/filters/ColorHalftoneFilter.js"></script>
<script>

  init = function () {
    container = document.getElementById("container");
    canvas = document.getElementById("canvas");
    filter = new tsunami.filters.ColorHalftoneFilter();
    image = new Image();
    image.onload = this.applyFilter.bind(this);
    image.src = '520297143_295x166.jpg';
  }

	applyFilter = function() {
    canvas.width = image.width * 2;
    canvas.height = image.height * 2;
		var context = canvas.getContext("2d");
		context.drawImage(image, 0, 0, canvas.width, canvas.height);
		setTimeout(this.waitForRedraw.bind(this), 100);
	}

	waitForRedraw = function() {
		var context = canvas.getContext("2d");
		// filter.pixelsPerPoint = eval(range.value);
		filter.pixelsPerPoint = 3;
		filter.applyFilter(context);
    filter.grayscale(context);
	}

</script>
</head>
<body onload="init()">
<div id="container">
	<canvas id="canvas"></canvas>
  <img src="520297143_295x166.jpg" />
</div>
</body>
</html>
